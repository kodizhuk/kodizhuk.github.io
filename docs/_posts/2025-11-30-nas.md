---
title:  "Домашній NAS"
last_modified_at: 2024-11-30T11:00:00+03:00
categories: 
  - blog
tags:
  - projects
  - nas
  - pc
  - linux
toc: true
toc_label: "Posts"
---

Мій домашній міні сервер

## Що таке NAS?

<figure>
  <a href="/assets/resources/nas-1.png"><img src="/assets/resources/nas-1.png"></a>
</figure>  

**NAS** (Network Attached Storage) - це компютер, який має декілька дисків, і який підключений до інтернету. Йому не потрібно монітора, мишки та клавіатури, все керування відбувається через інтернет - за допомогою веб інтерфейсу з гарними кнопочками, або через SSH (для просунутих користувачів).

Є декілька виробників, які роблять готові девайси - підключив і все працює. Вот для прикладу на два диски від Synology. Чому не один? Можна і один, але у випадку коли він помре (а це точно коли небудь відбудеться), вся інформація пропаде. Якщо є два, то можна на двох зберігати ті самі дані, і якщо один помре, то можна відновити дані з іншого.

<figure class="half">
  <a href="/assets/resources/nas-2.png"><img src="/assets/resources/nas-2.png"></a>
</figure>  

## Raid Масив

**RAID** (Redundant Array of Inexpensive Disks) - якщо простими словами, це коли ти використовуєш більше дисків чим потрібно, щоб мати можливість відновити дані з інших дисків якщо один помре.

Існує декілька стандартних RAID конфігурацій від RAID0 до RAID8, але не всі використовуються в наш час. Ось декілька поширених:

- **RAID0** - всі існуючі диски монтуються докупи і використовуються системою як один великий. Напр. якщо є 5 дисків по 10Тб, то в системі буде відображатися 50Тб вільного місця. В цьому варіанті немає можливості відновити інформацію якщо один з дисків вийде з ладу
- **RAID1**- всі існуючі диски діляться на дві частини і дублюються. Напр. якщо є 4 диски по 10Тб, то в системі буде відображатися як 20Тб. Якщо один поламається, то інформацію можна відновити з інших.
- **RAID5** - вся інформації розподіляється по всіх дисках. Крім самої записаної інформації додатково зберігається інформація парності. У випадку якщо один диск помер, можна відновити інформацію. Мінімальна кількість дисків - 3 шт. Якщо в нас три диски по 10Тб, то вільного місця в системі буде лише 20Тб.
<figure class="">
  <a href="/assets/resources/nas-3.png"><img src="/assets/resources/nas-3.png"></a>
</figure>  

Додатково ще бувають нестандартні, комбіновані і додаткові рівні RAID, можна почитати детальніше у вікі, лінк вкінці.

## Моя Конфігурація

Свій NAS я зібрав по відео від Linus Tech Tips

<iframe width="560" height="315" src="https://www.youtube.com/embed/boKmZKTKXHc" frameborder="0" allowfullscreen></iframe>

Корпус замовив на алі, материнка, процесор, диски найшов на olx. Саму збірку мого сервера можна глянути на Youtube

<iframe width="560" height="315" src="https://www.youtube.com/embed/ZACufXNEE3Q?si=10MD9aj_iUDzoECY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>



| Name | Model | Price, UAH |
| --- | --- | --- |
| Case | Jonsbo N1 case | 4296 |
| Motherboard | AMD B550 Mini-ITX | 6600 |
| CPU | Ryzen 3100 | 2000 |
| Drive (2 discs) | Exos X18 12Tb | 10839 |
| Power Supply | Seasonic Focus SGX 650 (ssr-650sgx) SFX-L | 3165 |
| SSD | Kingston A400 120 GB | 619 |
| Cash SSD | Intel Optane SSD M2 16Gb | 160 |
| RAM | Ripjaws V16 Gb (2x8GB) DDR4 3600 | 1369 |
| PCI-E to SATA | IO extension 2 sata ports | 407 |
|     |     | **29 455 UAH** |

Більшість компонетів купувалися бу, тому ціни такі.

Материнка має LAN вхід на 2.5Gbit, і якщо підключити через світч до компа, то все загружається на швидкості 2.5 Gbps = 312.5 MB/s. Краще будь якої флешки. Відео на 5Gbyte залиється за 15s.

Корпус мені подобається, компактний, на 5 дисків, хоч я використовую лише 2 слоти. Брав з розрахунком щоб поставити більше в майбутньому.

<figure class="half">
  <a href="/assets/resources/nas-4.png"><img src="/assets/resources/nas-4.png"></a>
</figure>  

У мене стоїть лише два диски, які підключені в паралель, тобто вся інформація дублюється. Кожен диск на 12Тб, але так як вони підключені в паралель то місця лише 12Тб. Поки що хватає для домашніх потреб. В мене він увімкнений 24/7.

Недоліки

- CPU - краще було би поставити Intel а не AMD. В Intel все набагато краще з декодуванням відео.
- GPU - непогано було би добавити якусь мінімальну GPU, бо проц сам з відео не справляється, особливо якщо стрімити 4k.
- Споживання в районі 50W, що досить багато в порівнянні з тим самим Synology, який в режимі очікування бере тільки десь 12W.
- В мене він стоїть в шафі, де мало простору. Температура дисків в районі 60deg. Поки що працюють.

## Операційна система

TrueNAS Scale - [truenas.com](https://www.truenas.com/docs/scale/)

Я спочатку поставив TrueNAS Core, яка створена на основі FreeBSD операційній системі. ЇЇ типу рекомендують як надійну яка просто працює. Недолік - там небагато прогам які можна встановити. 
Тому я перевстановив на TrueNAS Scale - вона створена на основі Ubuntu, відповідно програм набагато більше.  

Все керування відбувається через веб інтерфейс.

<figure class="half">
  <a href="/assets/resources/nas-5.png"><img src="/assets/resources/nas-5.png"></a>
  <a href="/assets/resources/nas-6.png"><img src="/assets/resources/nas-6.png"></a>
</figure>  


## Програми

Декілька програм які я використовую:

**AdGuard Home**
<br>DNS сервер, або просто - прога яка дозволяє фільтрувати рекламу, сайти, трекери

**Immich**
<br>свій домашній GooglePhoto, можна зберігати фоточки та відео в макс якості

**Jellyfin**
<br>свій домашній Netflix, можна дивитися свої фільми з будь якого пристрою. Зручне керування пультом на ТВ

**NextCloud**
<br>домашній Google Drive

**QBittorrent**
<br>прога для скачування торрентів.

**Gramps Web**
<br>прога де можна зберігати інформацію про своїх родичів, можна намалювати сімейне дерево з датами народження, смерті, місцем проживання ітп.

**Tailscale**
<br>VPN, дозволяє безпечно підключитися до домашнього сервера і всіх прог які на ньому

### AdGuard Home

Сайт - [adguard.com](https://adguard.com/uk/adguard-home/overview.html)

У веб інтерфейсі можна переглянути статистику. Я наприклад побачив що мій Dreeme порохотяг скидає дуууже багато інфи кудись в китай напевно. Відповідно всі запити автоматично блокуються.

<figure class="">
  <a href="/assets/resources/nas-7.png"><img src="/assets/resources/nas-7.png"></a>
</figure>  

### Immich

Сайт - [immich.app](https://immich.app/)

На вигляд прям копію Google Photo. Також вміє розпізнават обличчя, групувати місця по геолокації, будувати мапу місць де зроблені фото по геолокації. І це все працює локально, без зливання даних в інтернет. Можна запускати на компютері який взагалі не має інтернету. І основна фіча - всі фото зберігаються в максимальній якості, без стискання як це робить гугл фото.

<figure class="half">
  <a href="/assets/resources/nas-8.png"><img src="/assets/resources/nas-8.png"></a>
  <a href="/assets/resources/nas-9.png"><img src="/assets/resources/nas-9.png"></a>
</figure>  

### Jellyfin

сайт - [jellyfin.org](https://jellyfin.org/)

домашній Netflix. Можна переглядати домашню бібліотеку фільмів та серіалів в максимальній якості.

Основні фічі які мені подобаються:

- можна скачати фільми в 4к
- автоматично скачує інформацію про фільм з TBDb, список акторів, картинку
- зберігає місце на якому закінчено перегляд. Можна будь який фільм продовжити перегляд пізніше.
- можна встановлювати плагіни, напр пропустити інтро, субтитри

<figure class="half">
  <a href="/assets/resources/nas-10.png"><img src="/assets/resources/nas-10.png"></a>
  <a href="/assets/resources/nas-11.png"><img src="/assets/resources/nas-11.png"></a>
</figure>  

### NextCloud

сайт - [nextcloud.com](https://nextcloud.com/install/)

домашній google drive, можна зберігати фали, фото, відео, документи. Фото та відео не рекомендую , в мене чомусь воно працює дуже повільно, фоточки довго грузяться. Хз, мож то в мене щось помилка з налаштуваннями.

<figure class="">
  <a href="/assets/resources/nas-12.png"><img src="/assets/resources/nas-12.png"></a>
</figure>  

### QBittorrent

сайт - [qbittorrent.prg](https://www.qbittorrent.org/)

проста і без реклами прога для скачування торрентів. Так як в мене вона завжди запущена на сервері, то мені не потрібно чекати поки торрент загрузиться. Я просто з будь якого компа заходжу на IP адресу веб інтерфейсу, закидаю туди торрент файл, і він сам собі скачується.

Всі фільми автоматично підтягуються Jellyfin клієнтом.

Також відбуважться роздача торрентів, на поточний момент вже більше роздав чим закачав.

<figure class="">
  <a href="/assets/resources/nas-13.png"><img src="/assets/resources/nas-13.png"></a>
</figure>  

### Gramps Web

сайт - [grampsweb.org](https://www.grampsweb.org/)

ця прога працює теж локально. Вся інформація лише на вашому сервері.

Основні фічі:

- можна добавляти всіх родичів і створювати звязки між ними
- автоматично малює сімейне дерево
- можна експортувати pdf із днями народження всіх родичів, чи інші важливі дати
- можна добавити на карту місця проживання родичів
- має ще якісь фічі з ШІ, типу розпізнавання облич на фото та чат бот, але я ще не пробував

<figure class="">
  <a href="/assets/resources/nas-14.png"><img src="/assets/resources/nas-14.png"></a>
</figure>  

### Tailscale
сайт - [tailscale.com](https://tailscale.com/)

Я вставновив Tailscale на NAS та на смартфон та ноут. Підключившись до VPN мережі я маю доступ до домашньої мережі і всіх програм встановлених на NAS. Тобто я можу дивитися фільми із Jellyfin чи переглядати фото на Immich.

У безкоштовній версії можна підключити до 100 пристроїв.

<figure class="half">
  <a href="/assets/resources/nas-15.png"><img src="/assets/resources/nas-15.png"></a>
</figure>  

## Photos

<figure class="half">
  <a href="/assets/resources/nas-16.png"><img src="/assets/resources/nas-16.png"></a>
  <a href="/assets/resources/nas-17.png"><img src="/assets/resources/nas-17.png"></a>
  <a href="/assets/resources/nas-18.png"><img src="/assets/resources/nas-18.png"></a>
</figure>  


## Корисні посилання

- [uk.wikipedia.org/wiki/RAID](https://uk.wikipedia.org/wiki/RAID)

